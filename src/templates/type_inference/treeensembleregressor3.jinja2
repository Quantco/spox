if not self.inputs.fully_typed:
    return {}
shape = self.inputs.X.unwrap_tensor().shape
if shape.rank != 2:
    raise InferenceError("Expected input to be a matrix.")
sim = shape.to_simple()
assert sim is not None
n = sim[0]
e = self.attrs.n_targets.value if self.attrs.n_targets is not None else None
return {"Y": Tensor(np.float32, (n, e))}
